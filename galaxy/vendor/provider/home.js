var lastType,name="provider:home",nameVan="provider:home.van",lg=Logger,topic=new $.Topic,last=getExptCache(name);function lastTypeNeedRestart(){return("repeat"===lastType||"begin"===lastType)&&lastType}function callback(e){lg.debug("callback",name),dealData(name,e,noChange,hasChange,callbackErr)}function complete(){lg.debug("complete",name),topic.pub("complete",cache())}function noChange(e){lg.debug("noChange",name),topic.pub("none",cache())}function hasChange(e,a){lg.debug("hasChange",name),cacheData=null,topic.pub("change",e,cache())}function callbackErr(){Logger.out.error=["%s fetch error",name],topic.pub("error")}function loadData(e){if(e){e=e.replace(/{|-| |:|}/g,"");var a=getFileInfoData(nameVan);if(a&&e<=a)return complete();$.get($.urls.home,{success:function(e,a){callback(a),setFileInfo(nameVan,"",e,0)}.bind(null,e),error:callbackErr,complete:complete,timeout:3e3})}}last&&last.topic&&(topic._NS_Topic_once=last.topic._NS_Topic_once,topic._NS_topic=last.topic._NS_topic),last&&last.data&&(lastType=last.data.type,lastTypeNeedRestart()?last.data.clear():lastType=null),last=null;var cacheData,data=$.Timer(function(){lg.debug("fetchVanData",name),$.get($.urls.dataVanHome,{success:loadData,error:function(){callbackErr(),complete()},timeout:1500})},18e5);function cache(){if(cacheData)return sclone(cacheData);var e=getFileInfoData(name);return e?(cacheData=[],each(e,function(e){delete(cacheData[e.order]=e).order,e=null}),e=null,sclone(cacheData)):void 0}function margin(e){if($.UTIL.isFunction(e))return topic.once("complete",e),data.now(),!0}lastTypeNeedRestart()&&data[lastTypeNeedRestart()](),expt.rev=1,expt.expire=0,expt.margin=margin,expt.data=data,expt.cache=cache,expt.topic=topic;